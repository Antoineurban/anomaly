\documentclass{beamer}

\usepackage[utf8]{inputenc}
\usepackage[francais]{babel}
\usepackage{wrapfig}
\usepackage{amsmath}% http://ctan.org/pkg/amsmath
\usepackage{graphicx}

\usepackage{multirow}

\usepackage{sansmathaccent}
\pdfmapfile{+sansmathaccent.map}
\usepackage{tikz}
\usepackage{verbatim}

\setbeamertemplate{caption}{\raggedright\insertcaption\par}

\usetheme{Singapore}

\title{Détection d'anomalies de classification dans l'IoT via Machine Learning}
\author{Antoine Urban, Yohan Chalier}
\institute{Projet de filière SR2I \\ Télécom ParisTech}

\begin{document}

\begin{frame}
\titlepage
\end{frame}

\section{Introduction}

\begin{frame}{Introduction}
La détection d'obstacles: un enjeu de sécurité !
\begin{figure}
\centering
\includegraphics[width=.8\textwidth]{img/sensors.png}
\caption{Ensemble des capteurs présents dans le véhicule}
\end{figure}
\end{frame}

\begin{frame}{Attaques potentielles}

\begin{columns}

\begin{column}{0.5\textwidth}
\begin{figure}
\centering
\includegraphics[width=\textwidth]{img/blinding.png}
\caption{Attaque par aveuglement des capteurs}
\end{figure}
\end{column}

\begin{column}{0.5\textwidth}
\begin{figure}
\centering
\includegraphics[width=\textwidth]{img/data_flow.png}
\caption{Attaque par modification}
\end{figure}
\end{column}

\end{columns}

\end{frame}


\begin{frame}{Objectifs}
Proposition d'un modèle de classification multi-classes en réalisant un classeur à partir d'un algorithme d'apprentissage supervisé.
\end{frame}

\begin{frame}
\begin{figure}
\centering
\includegraphics[width=.9\textwidth]{img/structure.png}
\end{figure}
\end{frame}

\section{Démarche de recherche}

\begin{frame}{Première implémentation}
\begin{itemize}
\item Extraction des colonnes largeur et longueur de la base de données
\item Suppression des redondances
\item Définition de zones de décision arbitraires
\item Génération des données malicieuses
\end{itemize}
\begin{table}
\centering
\begin{tabular}{llll}
validité & intervalle de longueur & intervalle de largeur \\
\hline
non-malicieux & 3 à 6,5 mètres & 1,4 à 2,4 mètres \\
malicieux & 3 à 4,1 mètres & 2,05 à 2,4 mètres \\
malicieux & 5,25 à 6,5 mètres & 1,4 à 1,65 mètres \\
\end{tabular}
\end{table}
\end{frame}

\begin{frame}
\begin{figure}
\centering
\includegraphics[width=.8\textwidth]{img/first_try.png}
\end{figure}
\end{frame}

\begin{frame}{Méthodes d'évaluation}
\framesubtitle{Matrice de confusion}

\begin{tabular}{ l | l | c | c | c c}
\multicolumn{2}{c}{} & \multicolumn{2}{c}{Classe réelle} & \\
\cline{3-4}
\multicolumn{2}{c|}{} & Positif & Négatif \\
\cline{2-4}
\multirow{2}{*}{Classe prédite} & Positif & $TP$ & $FP$ & $PPV$ & $FDR$ \\
\cline{2-4}
& Négatif & $FN$ & $TN$ & $FOR$ & $NPV$ \\
\cline{2-4}
\multicolumn{1}{r}{} & \multicolumn{1}{l}{} & \multicolumn{1}{c}{$TPR$} & \multicolumn{1}{c}{$FPR$} \\
\multicolumn{1}{l}{} & \multicolumn{1}{l}{} & \multicolumn{1}{c}{$FNR$} & \multicolumn{1}{c}{$TNR$} \\
\end{tabular}

\end{frame}

\begin{frame}{Chargement des bases de données (1/2)}

\begin{enumerate}
\item Pour chaque jeu de données au format CSV
\begin{enumerate}[{1.}1.]
\item Lire les colonnes contenant la longueur et la largeur
\item Renommer ces colonnes en "\texttt{length}" et "\texttt{width}"
\item Supprimer les lignes incomplètes
\item Si nécessaire, convertir les données en flottant et en millimètres
\item Ajouter une colonne contenant la classe correspondant au jeu de données considéré
\item Appliquer un premier filtre sur la longueur ou la largeur pour supprimer les points extrêmes isolés
\end{enumerate}
\item Fusionner toutes les matrices précédentes en une seule
\item Créer un nouvel objet \texttt{Detector} avec cette matrice en attribut
\end{enumerate}

\end{frame}

\begin{frame}{Chargement des bases de données (2/2)}
\begin{enumerate}
\item Supprimer les éventuels redondances
\item Ajouter une colonne "\texttt{odd}" à la matrice, initialisée à \texttt{False}
\item \textbf{Générer les données malicieuses}
\item Ajouter les données malicieuses à la base de données, en rajoutant la colonne "\texttt{odd}" initialisée à \texttt{True}
\item Remplacer les valeurs des classes (originnellement des chaînes de caractères comme \texttt{"car"} ou \texttt{"human"}) par des entiers
\item \textbf{Séparer la matrice en un jeu d'entraînement et un jeu de test}
\item Renvoyer l'objet \texttt{Detector} ainsi initialisé
\end{enumerate}
\end{frame}

\begin{frame}{Classe \texttt{Detector}}
\begin{itemize}
\item Pré-traitement \begin{itemize}
\item \texttt{clean}
\item \texttt{append\_odd\_points}
\item \texttt{format}
\end{itemize}
\item Interface scikit-learn \begin{itemize}
\item \texttt{classify}
\item \texttt{tune\_parameters}
\item \texttt{predict}
\end{itemize}
\item Affichage \begin{itemize}
\item \texttt{plot}
\item  \texttt{plot\_decision\_boudaries}
\end{itemize}
\end{itemize}
\end{frame}

\begin{frame}{Méthodes d'évaluation}
\framesubtitle{Score F1}

\begin{block}{Objectif}
Maximisation du score F1 comme critère de performance
\end{block}

\begin{equation}
\text{f1-score} = \dfrac{2\times(\text{Recall} \times \text{Precision})}{(\text{Recall} + \text{Precision})} = 2\times\dfrac{PPV \times TPR}{PPV + TPR}
\end{equation}

\begin{equation}
\text{Precision} = \dfrac{TP}{TP+FP}
\end{equation}

\begin{equation}
\text{Recall} = \dfrac{TP}{TP+FN}
\end{equation}

\end{frame}

\end{document}
